{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "GCIS Extraction Schema",
  "description": "Standardized structure for modeling coffee extraction variables and predicted outcomes",
  "type": "object",
  "required": [
    "brew_method",
    "dose_g",
    "water_g",
    "grind_size_micron",
    "water_temperature_c",
    "contact_time_s",
    "agitation_level",
    "water_chemistry",
    "predicted_extraction"
  ],
  "properties": {

    "brew_method": {
      "type": "string",
      "enum": [
        "Espresso",
        "Pour Over",
        "Immersion",
        "Cold Brew",
        "Hybrid"
      ]
    },

    "dose_g": {
      "type": "number",
      "minimum": 1
    },

    "water_g": {
      "type": "number",
      "minimum": 1
    },

    "brew_ratio": {
      "type": "number",
      "description": "Optional explicit brew ratio if not inferred from dose/water"
    },

    "grind_size_micron": {
      "type": "number",
      "minimum": 100,
      "maximum": 2000
    },

    "water_temperature_c": {
      "type": "number",
      "minimum": 0,
      "maximum": 100
    },

    "contact_time_s": {
      "type": "number",
      "minimum": 1
    },

    "agitation_level": {
      "type": "string",
      "enum": [
        "Low",
        "Moderate",
        "High"
      ]
    },

    "water_chemistry": {
      "type": "object",
      "required": ["tds_ppm"],
      "properties": {
        "tds_ppm": {
          "type": "number",
          "minimum": 0
        },
        "hardness_ppm": {
          "type": "number",
          "minimum": 0
        },
        "alkalinity_ppm": {
          "type": "number",
          "minimum": 0
        }
      }
    },

    "predicted_extraction": {
      "type": "object",
      "required": [
        "estimated_extraction_yield_percent",
        "estimated_tds_percent",
        "balance_prediction"
      ],
      "properties": {

        "estimated_extraction_yield_percent": {
          "type": "number",
          "minimum": 0,
          "maximum": 30
        },

        "estimated_tds_percent": {
          "type": "number",
          "minimum": 0,
          "maximum": 15
        },

        "balance_prediction": {
          "type": "string",
          "enum": [
            "Under-Extracted",
            "Balanced",
            "Over-Extracted"
          ]
        },

        "sensory_prediction": {
          "type": "object",
          "properties": {
            "acidity_level": { "type": "number", "minimum": 0, "maximum": 10 },
            "sweetness_level": { "type": "number", "minimum": 0, "maximum": 10 },
            "bitterness_level": { "type": "number", "minimum": 0, "maximum": 10 },
            "body_level": { "type": "number", "minimum": 0, "maximum": 10 }
          }
        }
      }
    }
  }
}
